{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/demos.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'DBAY-RUSTYBUZZ/DEMOS'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nPATH                      = require 'path'\nFS                        = require 'fs'\n# H                         = require './helpers'\ntypes                     = new ( require 'intertype' ).Intertype\n{ isa\n  equals\n  type_of\n  validate\n  validate_list_of }      = types.export()\nSQL                       = String.raw\nguy                       = require '../../../apps/guy'\n# MMX                       = require '../../../apps/multimix/lib/cataloguing'\nRBW                       = require 'rustybuzz-wasm'\nH                         = require './helpers'\ncids_from_text            = ( text ) -> ( ( chr.codePointAt 0 ) for chr in Array.from text )\nZLIB                      = require 'zlib'\n\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\n@demo_load_font_outlines = ->\n  { DBay }            = require H.dbay_path\n  { Drb }             = require H.drb_path\n  { Tbl, }            = require '../../../apps/icql-dba-tabulate'\n  path                = '/tmp/dbay-rustybuzz.sqlite'\n  db                  = new DBay { path, }\n  schema              = 'drb'\n  drb                 = new Drb { db, create: true, schema, temporary: false, }\n  dtab                = new Tbl { db, }\n  # fontnick = 'jzr';   fspath = PATH.resolve PATH.join __dirname, '../../../', 'assets/jizura-fonts/jizura3b.ttf'\n  # fontnick = 'djvs';  fspath = PATH.resolve PATH.join __dirname, '../../../', 'assets/jizura-fonts/DejaVuSerif.ttf'\n  fontnick = 'qkai';  fspath = PATH.resolve PATH.join __dirname, '../../../', 'assets/jizura-fonts/cwTeXQKai-Medium.ttf'\n  drb.register_fontnick { fontnick, fspath, }\n  echo dtab._tabulate db SQL\"select * from #{schema}.outlines order by fontnick, gid;\"\n  echo dtab._tabulate db SQL\"select * from #{schema}.fontnicks order by fontnick;\"\n  whisper '^3334^', \"loading font #{rpr fontnick}...\"\n  drb.load_font { fontnick, }\n  whisper '^3334^', \"... done\"\n  #.........................................................................................................\n  # gid                 = drb.gids_from_cids { cids: ( cids_from_text 'O' ), fontnick, }\n  gid                 = 74\n  font_idx            = 0\n  # urge '^290^', outline = JSON.parse drb.RBW.glyph_to_svg_pathdata font_idx, gid\n  urge '^290^', { bbox, pd, } = drb.get_single_outline { fontnick, gid, }\n  #.........................................................................................................\n  ### TAINT obtain list of all valid Unicode codepoints (again) ###\n  cids                = cids_from_text \"sampletext算\"\n  # cids                = [ 0x0021 .. 0xd000 ]\n  cids                = [ 0x4e00 .. 0x9fff ]\n  # cids                = [ 0x4e00 .. 0x4e02 ]\n  t0                  = Date.now()\n  gid_by_cids         = drb.gids_from_cids { cids, fontnick, }\n  t1                  = Date.now()\n  ### TAINT might want to turn this into a benchmark (or improve reporting) ###\n  debug '^324^', cids.length      + ' cids'\n  debug '^324^', gid_by_cids.size + ' gids'\n  debug '^324^', ( dt = ( t1 - t0 ) / 1000 ) + 's'\n  help '^290^',  ( rpr gid_by_cids )[ ... 200 ] + '...'\n  #.........................................................................................................\n  insert_outlines_as_text = =>\n    insert_outline  = db.prepare drb.sql.insert_outline\n    t0                  = Date.now()\n    db =>\n      for gid from gid_by_cids.values()\n        { bbox: {\n            x, y, x1, y1, }\n          pd                } = drb.get_single_outline { gid, fontnick, }\n        insert_outline.run { fontnick, gid, x, y, x1, y1, pd, }\n    t1                  = Date.now()\n    debug '^324^', ( dt = ( t1 - t0 ) / 1000 ) + 's'\n  #.........................................................................................................\n  insert_outlines_as_brotli = =>\n    insert_outline      = db.prepare drb.sql.insert_outline_blob\n    t0                  = Date.now()\n    db =>\n      for gid from gid_by_cids.values()\n        { bbox: {\n            x, y, x1, y1, }\n          pd                } = drb.get_single_outline { gid, fontnick, }\n        pd                    = ZLIB.brotliCompressSync Buffer.from pd\n        insert_outline.run { fontnick, gid, x, y, x1, y1, pd, }\n    t1                  = Date.now()\n    debug '^324^', ( dt = ( t1 - t0 ) / 1000 ) + 's'\n  #.........................................................................................................\n  insert_outlines_as_deflateraw = =>\n    insert_outline      = db.prepare drb.sql.insert_outline_blob\n    t0                  = Date.now()\n    db =>\n      for gid from gid_by_cids.values()\n        { bbox: {\n            x, y, x1, y1, }\n          pd                } = drb.get_single_outline { gid, fontnick, }\n        pd                    = ZLIB.deflateRawSync Buffer.from pd\n        insert_outline.run { fontnick, gid, x, y, x1, y1, pd, }\n    t1                  = Date.now()\n    debug '^324^', ( dt = ( t1 - t0 ) / 1000 ) + 's'\n  #.........................................................................................................\n  insert_outlines_as_gzip = =>\n    insert_outline      = db.prepare drb.sql.insert_outline_blob\n    t0                  = Date.now()\n    db =>\n      for gid from gid_by_cids.values()\n        { bbox: {\n            x, y, x1, y1, }\n          pd                } = drb.get_single_outline { gid, fontnick, }\n        pd                    = ZLIB.gzipSync Buffer.from pd, { strategy: ZLIB.constants.Z_BEST_SPEED, }\n        insert_outline.run { fontnick, gid, x, y, x1, y1, pd, }\n    t1                  = Date.now()\n    debug '^324^', ( dt = ( t1 - t0 ) / 1000 ) + 's'\n  #.........................................................................................................\n  # insert_outlines_as_brotli()\n  # insert_outlines_as_deflateraw()\n  insert_outlines_as_gzip()\n  # insert_outlines_as_text()\n  #.........................................................................................................\n  echo dtab._tabulate db SQL\"\"\"\n    select\n        fontnick,\n        gid,\n        x,\n        y,\n        x1,\n        y1,\n        substring( pd, 0, 50 ) || '...' as \"(pd)\"\n      from #{schema}.outlines_blob\n      order by fontnick, gid\n      limit 10;\"\"\"\n  echo dtab._tabulate db SQL\"\"\"\n    with v1 as ( select count(*) as outline_count from #{schema}.outlines_blob )\n    select\n      v1.outline_count / ? as \"outlines per second\"\n    from v1;\"\"\", [ dt, ]\n  return null\n\n\n# #-----------------------------------------------------------------------------------------------------------\n# @demo_text_shaping = ->\n#   me                  = @new_demo()\n#   fontnick            = 'garamond_italic'\n#   font_idx            = @register_font me, fontnick\n#   size                = 5\n#   # format              = 'short'\n#   format              = 'json'\n#   # format              = 'rusty'\n#   text                = \"a certain minimum\"\n#   text                = text.replace /#/g, me.shy\n#   cfg                 = { format, text, }\n#   arrangement         = JSON.parse RBW.shape_text cfg\n#   debug '^4455^', arrangement\n#   debug '^4455^', RBW.shape_text { format: 'rusty', text, }\n#   #.........................................................................................................\n#   urge \"glyf IDs and positions of font #{rpr fontnick} for text #{rpr text}:\"\n#   for d in arrangement\n#     goid   = @_get_glyf_outline_id       fontnick, d.gid\n#     sgoid  = @_get_sized_glyf_outline_id fontnick, d.gid, size\n#     info '^223^', goid, sgoid\n#   #.........................................................................................................\n#   urge \"unique glyf IDs in this text:\"\n#   gids                = new Set ( d.gid for d in arrangement )\n#   debug '^3344^', gids\n#   return null\n\n# #-----------------------------------------------------------------------------------------------------------\n# @demo_svg_typesetting = ->\n#   me        = @new_demo()\n#   format    = 'json' # 'short', 'rusty'\n#   #.........................................................................................................\n#   fontnick  = 'tibetan';          text =  \"ཨོཾ་མ་ཎི་པདྨེ་ཧཱུྃ\"\n#   fontnick  = 'amiri';            text = ( [ \"الخط الأمیری\"... ].reverse() ).join ''\n#   fontnick  = 'garamond_italic';  text = \"a certain minimum\"\n#   fontnick  = 'garamond_italic';  text = \"af#fix\"\n#   #.........................................................................................................\n#   font_idx  = @register_font me, fontnick\n#   text      = text.replace /#/g, me.shy\n#   #.........................................................................................................\n#   echo \"\"\"<?xml version='1.0' encoding='UTF-8'?>\n#     <svg xmlns='http://www.w3.org/2000/svg' width='6000' height='3000' viewBox='-100 -1500 10500 1500' version='2'>\"\"\"\n#   cfg         = { format, text, }\n#   arrangement = JSON.parse RBW.shape_text cfg\n#   gids        = new Set ( d.gid for d in arrangement )\n#   debug '^3344^', gids\n#   #.........................................................................................................\n#   echo \"\"\"<style>\n#     path {\n#       stroke:                 transparent;\n#       stroke-width:           0mm;\n#       fill:                   black;; }\n#     rect {\n#       stroke:                 transparent;\n#       stroke-width:           0;\n#       fill:                   transparent; }\n#       </style>\"\"\"\n#   # echo \"\"\"<style>\n#   #   path {\n#   #     stroke:                 black;\n#   #     stroke-width:           8px;\n#   #     fill:                   #880000bd;; }\n#   #   rect {\n#   #     stroke:                 black;\n#   #     stroke-width:           3px;\n#   #     fill:                   #ffeb3b42; }\n#   #     </style>\"\"\"\n#   #.........................................................................................................\n#   echo \"<defs>\"\n#   for gid from gids.values()\n#     outline = JSON.parse RBW.glyph_to_svg_pathdata font_idx, gid\n#     debug '^3344^', gid, outline.pd[ .. 100 ]\n#     # continue if outline.pd is ''\n#     echo \"<symbol overflow='visible' id='b#{gid}'>#{outline.br}</symbol>\"\n#     echo \"<symbol overflow='visible' id='g#{gid}'><path d='#{outline.pd}'/></symbol>\"\n#   echo \"</defs>\"\n#   #.........................................................................................................\n#   for d in arrangement\n#     echo \"<use href='#g#{d.gid}' x='#{d.x}' y='#{d.y}'/>\"\n#     echo \"<use href='#b#{d.gid}' x='#{d.x}' y='#{d.y}'/>\"\n#     # echo \"<g x='#{d.x}' y='#{d.y + 1000}'>\"\n#     # echo \"#{outline.br}\"\n#     # echo \"</g>\"\n#   #.........................................................................................................\n#   echo \"</svg>\"\n#   return null\n\n\n############################################################################################################\nif require.main is module then do =>\n  await @demo_load_font_outlines()\n\n"
  ]
}