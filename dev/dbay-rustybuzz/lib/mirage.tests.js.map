{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/mirage.tests.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'DBAY-MIRAGE'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\ntest                      = require '../../../apps/guy-test'\nPATH                      = require 'path'\n# FS                        = require 'fs'\nH                         = require './helpers'\ntypes                     = new ( require 'intertype' ).Intertype\n{ isa\n  equals\n  type_of\n  validate\n  validate_list_of }      = types.export()\nSQL                       = String.raw\nguy                       = require '../../../apps/guy'\n\n\n\n# #-----------------------------------------------------------------------------------------------------------\n# @[ \"location marker matching\" ] = ( T, done ) ->\n#   # T?.halt_on_error()\n#   { Mrg } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n#   #.........................................................................................................\n#   probes_and_matchers = [\n#     [ '<mrg:loc#first/>',         [ [ '', '<mrg:loc#first/>', ''       ], { locid: 'first'        }, ], ]\n#     [ '<mrg:loc#foo-bar-123/>',   [ [ '', '<mrg:loc#foo-bar-123/>', '' ], { locid: 'foo-bar-123'  }, ], ]\n#     [ '<mrg:loc# foo-bar-123/>',  [ [ '<mrg:loc# foo-bar-123/>'        ], { locid: ' foo-bar-123' }, ], ]\n#     [ '<MRG:loc#foo-bar-123/>',   [ [ '<MRG:loc#foo-bar-123/>'         ], { locid: 'foo-bar-123'  }, ], ]\n#     [ '<mrg:loc#first />',        [ [ '<mrg:loc#first />'              ], { locid: 'first '       }, ], ]\n#     [ '<mrg:loc id=\"first\"/>',    [ [ '<mrg:loc id=\"first\"/>'          ], null                     , ], ]\n#     [ '<mrg:loc#first>',          [ [ '<mrg:loc#first>'                ], { locid: 'first>'       }, ], ]\n#     ]\n#   #.........................................................................................................\n#   for [ probe, matcher, error, ] in probes_and_matchers\n#     await T.perform probe, matcher, error, -> return new Promise ( resolve, reject ) ->\n#       # result = ( { d.groups..., } for d from probe.matchAll Mrg.C.defaults.constructor_cfg.loc_splitter )\n#       result = [\n#         ( probe.split Mrg.C.defaults.constructor_cfg.loc_splitter ),\n#         ( ( probe.match Mrg.C.defaults.constructor_cfg.locid_re )?.groups ? null ) ]\n#       resolve result\n#       return null\n#   #.........................................................................................................\n#   done()\n#   return null\n\n# #-----------------------------------------------------------------------------------------------------------\n# @[ \"___ extended location marker matching\" ] = ( T, done ) ->\n#   # T?.halt_on_error()\n#   { Mrg } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n#   #.........................................................................................................\n#   probes_and_matchers = [\n#     [ '<mrg:loc.delete#title/>',         [ [ '', '<mrg:loc#first/>', ''       ], { locid: 'first'        }, ], ]\n#     [ '<mrg:loc#title.delete/>',         [ [ '', '<mrg:loc#first/>', ''       ], { locid: 'first'        }, ], ]\n#     ]\n#   #.........................................................................................................\n#   for [ probe, matcher, error, ] in probes_and_matchers\n#     await T.perform probe, matcher, error, -> return new Promise ( resolve, reject ) ->\n#       # result = ( { d.groups..., } for d from probe.matchAll Mrg.C.defaults.constructor_cfg.loc_splitter )\n#       result = [\n#         ( probe.split Mrg.C.defaults.constructor_cfg.loc_splitter ),\n#         ( ( probe.match Mrg.C.defaults.constructor_cfg.locid_re )?.groups ? null ) ]\n#       naked_probe = probe[ 1 ... probe.length - 2 ]\n#       debug '^545575^', INTERTEXT.HTML.parse_compact_tagname naked_probe\n#       resolve result\n#       return null\n#   #.........................................................................................................\n#   done()\n#   return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"mrg.refresh_datasource\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { DBay  } = require H.dbay_path\n  { Mrg   } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n  # { Drb }   = require H.drb_path\n  db        = new DBay()\n  mrg       = new Mrg { db, }\n  dsk       = 'sp'\n  path      = 'short-proposal.mkts.md'\n  path      = PATH.resolve PATH.join __dirname, '../../../assets', path\n  mrg.register_dsk { dsk, path, }\n  #.........................................................................................................\n  do =>\n    result  = mrg.refresh_datasource { dsk, }\n    debug '^44498^', result\n    T?.eq result, { files: 1, bytes: 384 }\n  #.........................................................................................................\n  do =>\n    result  = mrg.refresh_datasource { dsk, }\n    debug '^44498^', result\n    T?.eq result, { files: 0, bytes: 0 }\n  #.........................................................................................................\n  do =>\n    mrg._update_digest dsk, null\n    result  = mrg.refresh_datasource { dsk, }\n    debug '^44498^', result\n    T?.eq result, { files: 1, bytes: 384 }\n  #.........................................................................................................\n  do =>\n    result  = mrg.refresh_datasource { dsk, force: true, }\n    debug '^44498^', result\n    T?.eq result, { files: 1, bytes: 384 }\n  #.........................................................................................................\n  done?()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"altering mirrored source lines causes error\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { DBay  } = require H.dbay_path\n  { Mrg   } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n  # { Drb }   = require H.drb_path\n  db        = new DBay()\n  mrg       = new Mrg { db, }\n  dsk       = 'twcm'\n  path      = 'dbay-rustybuzz/template-with-content-markers.html'\n  path      = PATH.resolve PATH.join __dirname, '../../../assets', path\n  mrg.register_dsk { dsk, path, }\n  mrg.refresh_datasource { dsk, }\n  console.table db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  rows_before = db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  #.........................................................................................................\n  do =>\n    error = null\n    try\n      db SQL\"\"\"insert into mrg_mirror\n        ( dsk, lnr, lnpart, xtra, locid, line )\n        values ( $dsk, $lnr, $lnpart, $xtra, $locid, $line )\"\"\", {\n          dsk:      dsk,\n          lnr:      10,\n          lnpart:   0,\n          xtra:     0,\n          locid:    null,\n          line:     \"some text\", }\n    catch error\n      warn CND.reverse error.message\n      T?.ok ( /not allowed to modify table mrg_mirror/ ).test error.message\n    T?.ok error?\n  #.........................................................................................................\n  console.table db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  rows_after = db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  T?.eq rows_before, rows_after\n  #.........................................................................................................\n  done?()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"loc markers 1\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { DBay  } = require H.dbay_path\n  { Mrg   } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n  # { Drb }   = require H.drb_path\n  db        = new DBay()\n  mrg       = new Mrg { db, }\n  dsk       = 'twcm'\n  path      = 'dbay-rustybuzz/template-with-content-markers.html'\n  path      = PATH.resolve PATH.join __dirname, '../../../assets', path\n  mrg.register_dsk { dsk, path, }\n  info '^33298-1^', mrg.refresh_datasource { dsk, }\n  #.........................................................................................................\n  console.table db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  console.table db.all_rows SQL\"select * from mrg_locs   order by dsk, locid;\"\n  T?.eq ( db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\" ), [\n    { dsk: 'twcm', lnr: 1, lnpart: 0, xtra: 0, locid: null, line: '<title>' },\n    { dsk: 'twcm', lnr: 1, lnpart: 1, xtra: 0, locid: 'title', line: '<mrg:loc.delete-marker#title/>' },\n    { dsk: 'twcm', lnr: 1, lnpart: 2, xtra: 0, locid: null, line: '</title>' },\n    { dsk: 'twcm', lnr: 2, lnpart: 0, xtra: 0, locid: null, line: '<article>' },\n    { dsk: 'twcm', lnr: 3, lnpart: 0, xtra: 0, locid: null, line: '  <p>Here comes some ' },\n    { dsk: 'twcm', lnr: 3, lnpart: 1, xtra: 0, locid: 'content', line: '<mrg:loc#content/>' },\n    { dsk: 'twcm', lnr: 3, lnpart: 2, xtra: 0, locid: null, line: '.</p>' },\n    { dsk: 'twcm', lnr: 4, lnpart: 0, xtra: 0, locid: null, line: '  </article>' },\n    { dsk: 'twcm', lnr: 5, lnpart: 0, xtra: 0, locid: null, line: '' } ]\n  T?.eq ( db.all_rows SQL\"select * from mrg_locs order by dsk, locid;\" ), [\n    { dsk: 'twcm', locid: 'content', lnr: 3, lnpart: 1, props: null, del: 0, },\n    { dsk: 'twcm', locid: 'title', lnr: 1, lnpart: 1, props: '[\"delete-marker\"]', del: 1, } ]\n  #.........................................................................................................\n  done()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"loc markers 2\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { DBay  } = require H.dbay_path\n  { Mrg   } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n  # { Drb }   = require H.drb_path\n  db        = new DBay()\n  mrg       = new Mrg { db, }\n  dsk       = 'twcm'\n  path      = 'dbay-rustybuzz/template-with-content-markers.html'\n  path      = PATH.resolve PATH.join __dirname, '../../../assets', path\n  #.........................................................................................................\n  mrg.register_dsk { dsk, path, }\n  mrg.refresh_datasource { dsk, }\n  #.........................................................................................................\n  console.table db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  rows = db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  T?.eq rows[ 0 ], { dsk: 'twcm', lnr: 1, lnpart: 0, xtra: 0, locid: null, line: '<title>'               }\n  T?.eq rows[ 1 ], { dsk: 'twcm', lnr: 1, lnpart: 1, xtra: 0, locid: 'title', line: '<mrg:loc.delete-marker#title/>'      }\n  T?.eq rows[ 2 ], { dsk: 'twcm', lnr: 1, lnpart: 2, xtra: 0, locid: null, line: '</title>'              }\n  T?.eq rows[ 3 ], { dsk: 'twcm', lnr: 2, lnpart: 0, xtra: 0, locid: null, line: '<article>'             }\n  T?.eq rows[ 4 ], { dsk: 'twcm', lnr: 3, lnpart: 0, xtra: 0, locid: null, line: '  <p>Here comes some ' }\n  T?.eq rows[ 5 ], { dsk: 'twcm', lnr: 3, lnpart: 1, xtra: 0, locid: 'content', line: '<mrg:loc#content/>'    }\n  T?.eq rows[ 6 ], { dsk: 'twcm', lnr: 3, lnpart: 2, xtra: 0, locid: null, line: '.</p>'                 }\n  T?.eq rows[ 7 ], { dsk: 'twcm', lnr: 4, lnpart: 0, xtra: 0, locid: null, line: '  </article>'          }\n  T?.eq rows[ 8 ], { dsk: 'twcm', lnr: 5, lnpart: 0, xtra: 0, locid: null, line: ''                      }\n  T?.eq ( mrg.append_to_loc { dsk, locid: 'title',  text: \"A Grand Union\" } ), { dsk: 'twcm', lnr: 1, lnpart: 1, xtra: 1, locid: null, line: 'A Grand Union' }\n  T?.eq ( mrg.append_to_loc { dsk, locid: 'content', text: \"more \"        } ), { dsk: 'twcm', lnr: 3, lnpart: 1, xtra: 1, locid: null, line: 'more ' }\n  T?.eq ( mrg.append_to_loc { dsk, locid: 'content', text: \"content\"      } ), { dsk: 'twcm', lnr: 3, lnpart: 1, xtra: 2, locid: null, line: 'content' }\n  # info '^33298-4^', mrg.prepend_to_loc { dsk, locid: 'content', text: \"content goes here\" }\n  console.table db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  rows = db.all_rows SQL\"select * from mrg_mirror order by dsk, lnr, lnpart;\"\n  T?.eq rows[ 0  ], { dsk: 'twcm', lnr: 1, lnpart: 0, xtra: 0, locid: null, line: '<title>'               }\n  T?.eq rows[ 1  ], { dsk: 'twcm', lnr: 1, lnpart: 1, xtra: 0, locid: 'title', line: '<mrg:loc.delete-marker#title/>'      }\n  T?.eq rows[ 2  ], { dsk: 'twcm', lnr: 1, lnpart: 1, xtra: 1, locid: null, line: 'A Grand Union'         }\n  T?.eq rows[ 3  ], { dsk: 'twcm', lnr: 1, lnpart: 2, xtra: 0, locid: null, line: '</title>'              }\n  T?.eq rows[ 4  ], { dsk: 'twcm', lnr: 2, lnpart: 0, xtra: 0, locid: null, line: '<article>'             }\n  T?.eq rows[ 5  ], { dsk: 'twcm', lnr: 3, lnpart: 0, xtra: 0, locid: null, line: '  <p>Here comes some ' }\n  T?.eq rows[ 6  ], { dsk: 'twcm', lnr: 3, lnpart: 1, xtra: 0, locid: 'content', line: '<mrg:loc#content/>'    }\n  T?.eq rows[ 7  ], { dsk: 'twcm', lnr: 3, lnpart: 1, xtra: 1, locid: null, line: 'more '                 }\n  T?.eq rows[ 8  ], { dsk: 'twcm', lnr: 3, lnpart: 1, xtra: 2, locid: null, line: 'content'               }\n  T?.eq rows[ 9  ], { dsk: 'twcm', lnr: 3, lnpart: 2, xtra: 0, locid: null, line: '.</p>'                 }\n  T?.eq rows[ 10 ], { dsk: 'twcm', lnr: 4, lnpart: 0, xtra: 0, locid: null, line: '  </article>'          }\n  T?.eq rows[ 11 ], { dsk: 'twcm', lnr: 5, lnpart: 0, xtra: 0, locid: null, line: ''                      }\n  #.........................................................................................................\n  for { line, } from mrg.walk_line_rows { dsk, }\n    urge '^587^', rpr line\n  T?.eq ( mrg.get_line_rows { dsk, } ), [\n    { dsk: 'twcm', lnr: 1, line: '<title><mrg:loc.delete-marker#title/>A Grand Union</title>'             },\n    { dsk: 'twcm', lnr: 2, line: '<article>'                                                },\n    { dsk: 'twcm', lnr: 3, line: '  <p>Here comes some <mrg:loc#content/>more content.</p>' },\n    { dsk: 'twcm', lnr: 4, line: '  </article>'                                             },\n    { dsk: 'twcm', lnr: 5, line: ''                                                         } ]\n  #.........................................................................................................\n  done?()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"loc markers 3\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { DBay  } = require H.dbay_path\n  { Mrg   } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n  # { Drb }   = require H.drb_path\n  db        = new DBay()\n  mrg       = new Mrg { db, }\n  dsk       = 'twcm'\n  path      = 'dbay-rustybuzz/template-with-content-markers.html'\n  path      = PATH.resolve PATH.join __dirname, '../../../assets', path\n  #.........................................................................................................\n  mrg.register_dsk { dsk, path, }\n  mrg.refresh_datasource { dsk, }\n  #.........................................................................................................\n  mrg.append_to_loc { dsk, locid: 'title',  text: \"A Grand Union\" }\n  mrg.append_to_loc { dsk, locid: 'content', text: \"more \"        }\n  mrg.append_to_loc { dsk, locid: 'content', text: \"content\"      }\n  T?.eq ( mrg.get_text { dsk, keep_locs: null,  } ), '<title>A Grand Union</title>\\n<article>\\n  <p>Here comes some <mrg:loc#content/>more content.</p>\\n  </article>\\n'\n  T?.eq ( mrg.get_text { dsk, keep_locs: true,  } ), '<title><mrg:loc.delete-marker#title/>A Grand Union</title>\\n<article>\\n  <p>Here comes some <mrg:loc#content/>more content.</p>\\n  </article>\\n'\n  T?.eq ( mrg.get_text { dsk, keep_locs: false, } ), '<title>A Grand Union</title>\\n<article>\\n  <p>Here comes some more content.</p>\\n  </article>\\n'\n  #.........................................................................................................\n  done?()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"multiple loc markers in one line\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { DBay  } = require H.dbay_path\n  { Mrg   } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n  # { Drb }   = require H.drb_path\n  db        = new DBay()\n  mrg       = new Mrg { db, }\n  dsk       = 'twcm2'\n  path      = 'dbay-rustybuzz/template-with-content-markers-2.html'\n  path      = PATH.resolve PATH.join __dirname, '../../../assets', path\n  #.........................................................................................................\n  mrg.register_dsk { dsk, path, }\n  mrg.refresh_datasource { dsk, }\n  #.........................................................................................................\n  mrg.append_to_loc { dsk, locid: 'title',  text: \"A Grand Union\" }\n  mrg.append_to_loc { dsk, locid: 'some-content', text: \"some content\"      }\n  mrg.append_to_loc { dsk, locid: 'more-content', text: \"and more content\"  }\n  debug '^45346^', mrg.get_text { dsk, keep_locs: null,  }\n  T?.eq ( mrg.get_text { dsk, keep_locs: null,  } ), '<title>A Grand Union</title>\\n<article>\\n  <p>Here comes some <mrg:loc#some-content/>some content and some more <mrg:loc#more-content/>and more content.</p>\\n  </article>\\n'\n  T?.eq ( mrg.get_text { dsk, keep_locs: true,  } ), '<title><mrg:loc.delete-marker#title/>A Grand Union</title>\\n<article>\\n  <p>Here comes some <mrg:loc#some-content/>some content and some more <mrg:loc#more-content/>and more content.</p>\\n  </article>\\n'\n  T?.eq ( mrg.get_text { dsk, keep_locs: false, } ), '<title>A Grand Union</title>\\n<article>\\n  <p>Here comes some some content and some more and more content.</p>\\n  </article>\\n'\n  #.........................................................................................................\n  done?()\n  return null\n\n\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"loc markers 4\" ] = ( T, done ) ->\n  T?.halt_on_error()\n  { DBay  } = require H.dbay_path\n  { Mrg   } = require '../../../apps/dbay-rustybuzz/lib/_mirage'\n  # { Drb }   = require H.drb_path\n  db        = new DBay()\n  mrg       = new Mrg { db, }\n  dsk       = 'twcm'\n  path      = 'dbay-rustybuzz/template-with-content-markers.html'\n  path      = PATH.resolve PATH.join __dirname, '../../../assets', path\n  #.........................................................................................................\n  debug '^68667-1^'\n  mrg.register_dsk { dsk, path, }\n  mrg.refresh_datasource { dsk, }\n  #.........................................................................................................\n  debug '^68667-2^'\n  db.setv 'dsk',    dsk\n  db.setv 'locid',  'title'\n  console.table db.all_rows SQL\"select * from mrg_location_from_dsk_locid;\"\n  console.table db.all_rows SQL\"select * from mrg_prv_nxt_xtra_from_dsk_locid;\"\n  #.........................................................................................................\n  do =>\n    error = null\n    db.setv 'dsk',    dsk\n    db.setv 'locid',  'nonexistentloc'\n    debug '^68667-3^'\n    try\n      console.table db.all_rows SQL\"select * from mrg_location_from_dsk_locid;\"\n    catch error\n      help '^68667-4^', CND.reverse error.message\n      T?.ok ( error.message.match /unknown locid/ )?\n    debug '^68667-5^'\n    T?.ok error?\n  #.........................................................................................................\n  do =>\n    error = null\n    db.setv 'dsk',    dsk\n    db.setv 'locid',  'nonexistentloc'\n    debug '^68667-6^'\n    try\n      console.table db.all_rows SQL\"select * from mrg_prv_nxt_xtra_from_dsk_locid;\"\n    catch error\n      help '^68667-7^', CND.reverse error.message\n      T?.ok ( error.message.match /unknown locid/ )?\n    debug '^68667-8^'\n    T?.ok error?\n  #.........................................................................................................\n  do =>\n    debug '^68667-9^'\n    error = null\n    try\n      mrg.append_to_loc { dsk, locid: 'nonexistentloc',  text: \"A Grand Union\" }\n    catch error\n      help '^68667-10^', CND.reverse error.message\n      T?.ok ( error.message.match /unknown locid/ )?\n    debug '^68667-11^'\n    T?.ok error?\n  #.........................................................................................................\n  done?()\n  return null\n\n\n\n############################################################################################################\nif require.main is module then do =>\n  # test @\n  # test @[ \"altering mirrored source lines causes error\" ]\n  # @[ \"altering mirrored source lines causes error\" ]()\n  # test @[ \"location marker matching\" ]\n  # test @[ \"mrg.refresh_datasource\" ]\n  # test @[ \"loc markers 1\" ]\n  # test @[ \"loc markers 2\" ]\n  # test @[ \"loc markers 3\" ]\n  # test @[ \"loc markers 4\" ]\n  # test @[ \"extended location marker matching\" ]\n  test @[ \"multiple loc markers in one line\" ]\n\n"
  ]
}