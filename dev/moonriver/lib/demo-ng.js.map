{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/demo-ng.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nGUY                       = require 'guy'\n{ alert\n  debug\n  help\n  info\n  plain\n  praise\n  urge\n  warn\n  whisper }               = GUY.trm.get_loggers 'MOONRIVER/NG'\n{ rpr\n  inspect\n  echo\n  log     }               = GUY.trm\n#...........................................................................................................\ntypes                     = new ( require 'intertype' ).Intertype()\n{ isa\n  type_of\n  validate\n  validate_optional }     = types\nUTIL                      = require 'node:util'\n{ hide\n  def }                   = GUY.props\nnameit                    = ( name, f ) -> def f, 'name', { value: name, }\n\n#===========================================================================================================\nclass Segment\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg ) ->\n    @input      = cfg.input  ? []\n    @output     = cfg.output ? []\n    name        = cfg.transform.name\n    name        = 'ƒ' if name is ''\n    hide @, 'transform', nameit name, cfg.transform.bind @ ### binding is optional ###\n    hide @, '_send', send = ( d ) => @output.push d; d ### 'inner' send method ###\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  ### 'outer' send method ###\n  send: ( d ) -> @input.push d; d\n\n  #---------------------------------------------------------------------------------------------------------\n  process: ->\n    if @input.length > 0\n      @transform.call null, @input.shift(), @_send\n      return 1\n    return 0\n\n  #---------------------------------------------------------------------------------------------------------\n  [UTIL.inspect.custom]:  -> @toString()\n  toString:               -> \"#{rpr @input} ▶ #{@transform.name} ▶ #{rpr @output}\"\n\n#===========================================================================================================\nclass Reporting_collector\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( callback ) ->\n    hide @, 'callback', callback\n    hide @, 'd',        []\n    GUY.props.def @,  'length',   get: -> @d.length\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  push:     ( d ) -> @callback +1; @d.push d\n  unshift:  ( d ) -> @callback +1; @d.unshift d\n  pop:            -> @callback -1; @d.pop()\n  shift:          -> @callback -1; @d.shift()\n\n  #---------------------------------------------------------------------------------------------------------\n  [UTIL.inspect.custom]:  -> @toString()\n  toString:               -> rpr @d\n\n\n#===========================================================================================================\nclass Pipeline\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg ) ->\n    cfg                 = { {}..., cfg..., }\n    # cfg                 = types.create.mr_pipeline_cfg cfg\n    @datacount          = 0\n    @input              = @_new_collector()\n    @output             = [] ### pipeline output buffer does not participate in datacount ###\n    @segments           = []\n    @on_before_step     = cfg.on_before_step ? null\n    @on_after_step      = cfg.on_after_step  ? null\n    @on_before_process  = cfg.on_before_process ? null\n    @on_after_process   = cfg.on_after_process  ? null\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  _new_collector: -> new Reporting_collector ( delta ) => @datacount += delta\n\n  #---------------------------------------------------------------------------------------------------------\n  push: ( transform ) ->\n    if ( count = @segments.length ) is 0\n      input               = @input\n    else\n      prv_segment         = @segments[ count - 1 ]\n      prv_segment.output  = @_new_collector()\n      input               = prv_segment.output\n    R = new Segment { input, transform, output: @output, }\n    @segments.push R\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  send: ( d ) -> @input.push d; d\n\n  #---------------------------------------------------------------------------------------------------------\n  process: ->\n    @on_before_process() if @on_before_process?\n    for segment, segment_idx in @segments\n      @on_before_step segment_idx if @on_before_step?\n      segment.process()\n      @on_after_step segment_idx if @on_after_step?\n    @on_after_process() if @on_after_process?\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  run: -> ( d for d from @walk() )\n\n  #---------------------------------------------------------------------------------------------------------\n  walk: ->\n    loop\n      @process()\n      yield d for d in @output\n      @output.length = []\n      # yield @output.shift() while @output.length > 0\n      break if @datacount < 1\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  [UTIL.inspect.custom]:  -> @toString()\n  toString:               ->\n    R = []\n    for segment in @segments\n      R.push rpr segment.input\n      R.push '▶'\n      R.push segment.transform.name\n      R.push '▶'\n    R.push rpr @output\n    return R.join ' '\n\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\n\n\n\n############################################################################################################\nif module is require.main then do =>\n  on_before_process = -> urge @\n  on_after_process  = -> urge @\n  on_before_step    =  ( sidx ) -> urge sidx, @\n  on_after_step     =  ( sidx ) -> urge sidx, @\n  on_before_step    = null\n  on_after_step     = null\n  p = new Pipeline { on_before_process, on_after_step, on_after_process, }\n  p.push times_2 = ( d, send ) ->\n    if isa.float d\n      # send '('\n      send d * 2\n      # send ')'\n    else\n      send d\n  p.push plus_2  = ( d, send ) ->\n    if isa.float d\n      # send '['\n      send d + 2\n      # send ']'\n    else\n      send d\n  p.push times_3 = ( d, send ) ->\n    if isa.float d\n      # send '{'\n      send d * 3\n      # send '}'\n    else\n      send d\n  p.send 1\n  p.send 2\n  p.send 3\n  # urge '^97-4^', d for d from p.walk()\n  urge '^97-4^', p.run()\n  return null\n"
  ]
}