{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/basic.tests.coffee"
  ],
  "names": [],
  "mappings": "AACA;EAAA;AAAA,MAAA,GAAA,EAAA,CAAA,EAAA,IAAA,EAAA,GAAA,EAAA,KAAA,EAAA,KAAA,EAAA,IAAA,EAAA,MAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,OAAA,EAAA,KAAA,EAAA,IAAA,EAAA,QAAA,EAAA,gBAAA,EAAA,IAAA,EAAA,OAAA;;;EAIA,GAAA,GAA4B,OAAA,CAAQ,KAAR;;EAC5B,GAAA,GAA4B,GAAG,CAAC;;EAChC,KAAA,GAA4B;;EAC5B,KAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,OAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,MAAf,EAA4B,KAA5B;;EAC5B,OAAA,GAA4B,GAAG,CAAC,UAAJ,CAAe,SAAf,EAA4B,KAA5B;;EAC5B,IAAA,GAA4B,GAAG,CAAC,IAAI,CAAC,IAAT,CAAc,GAAd,EAb5B;;;EAeA,IAAA,GAA4B,OAAA,CAAQ,wBAAR;;EAC5B,IAAA,GAA4B,OAAA,CAAQ,MAAR,EAhB5B;;;EAkBA,KAAA,GAA4B,IAAI,CAAE,OAAA,CAAQ,WAAR,CAAF,CAAuB,CAAC,SAA5B,CAAA;;EAC5B,CAAA,CAAE,GAAF,EACE,MADF,EAEE,OAFF,EAGE,QAHF,EAIE,gBAJF,CAAA,GAI4B,KAAK,CAAC,MAAN,CAAA,CAJ5B;;EAKA,GAAA,GAA4B,MAAM,CAAC;;EACnC,GAAA,GAA4B,OAAA,CAAQ,mBAAR;;EAC5B,CAAA,GAA4B,OAAA,CAAQ,sBAAR,EA1B5B;;;;;;;;;;EAsCA,IAAC,CAAE,iBAAF,CAAD,GAAyB,QAAA,CAAE,CAAF,EAAK,IAAL,CAAA;AACzB,QAAA,KAAA,EAAA,SAAA;;IACE,CAAA,CAAE,SAAF,EACE,KADF,CAAA,GACgB,OAAA,CAAQ,yBAAR,CADhB;IAGG,CAAA,CAAA,CAAA,GAAA,EAAA;AACL,UAAA,SAAA,EAAA,EAAA,EAAA;MAAI,SAAA,GAAY;MACZ,QAAA,GAAY;QACV,CAAE,CAAF;QAAK,CAAL;QAAQ,CAAR;QAAW,CAAX,CADU;QAEV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;iBAAe,IAAA,CAAK,CAAA,GAAI,CAAT;QAAf,CAFU;QAGV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;iBAAe,IAAA,CAAK,CAAL,EAAf;QAAA,CAHU;QAIV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;iBAAe,SAAS,CAAC,IAAV,CAAe,CAAf,EAAf;QAAA,CAJU;;MAMZ,EAAA,GAAK,IAAI,SAAJ,CAAc,QAAd;MACL,EAAE,CAAC,KAAH,CAAA;yBACA,CAAC,CAAE,EAAH,CAAM,SAAN,EAAiB,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,EAAX,CAAjB;IAVC,CAAA;IAYA,CAAA,CAAA,CAAA,GAAA,EAAA;AACL,UAAA,SAAA,EAAA,EAAA,EAAA;MAAI,SAAA,GAAY;MACZ,QAAA,GAAY;QACV,CAAE,GAAF;QAAO,GAAP,CADU;QAEV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;UAAe,IAAA,CAAK,OAAL;QAAc,CAAd;iBAAiB,IAAA,CAAK,CAAL;QAAhC,CAFU;QAGV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;AACN,cAAA,CAAA;QAAA;UAAQ,IAAA,CAAK,CAAL;UACA,IAAG,IAAI,CAAC,UAAL,KAAmB,CAAtB;AACE;YAAA,KAAA,QAAA;cAAA,IAAA,CAAK,CAAL;YAAA,CADF;;AAEA,iBAAO;QAJT,CAHU;QAQV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;iBAAe,IAAA,CAAQ,GAAG,CAAC,KAAJ,CAAU,CAAV,CAAH,GAAoB,CAAA,GAAI,CAAxB,GAA+B,CAApC;QAAf,CARU;QASV,QAAA,CAAE,CAAF,CAAA;iBAAe,IAAA,CAAK,CAAL;QAAf,CATU;QAUV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;iBAAe,SAAS,CAAC,IAAV,CAAe,CAAf,EAAf;QAAA,CAVU;;MAYZ,EAAA,GAAK,IAAI,SAAJ,CAAc,QAAd;MACL,EAAE,CAAC,KAAH,CAAA;yBACA,CAAC,CAAE,EAAH,CAAM,SAAN,EAAiB,CAAE,GAAF,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,EAAhB,EAAoB,GAApB,CAAjB;IAhBC,CAAA;;MAkBH;;AACA,WAAO;EApCgB,EAtCzB;;;EA6EA,IAAC,CAAE,0DAAF,CAAD,GAAkE,QAAA,CAAE,CAAF,EAAK,IAAL,CAAA;AAClE,QAAA,SAAA;;IACE,CAAA,CAAE,SAAF,CAAA,GAAgB,OAAA,CAAQ,yBAAR,CAAhB;IAEG,CAAA,CAAA,CAAA,GAAA,EAAA;AACL,UAAA,qBAAA,EAAA,qBAAA,EAAA,SAAA,EAAA,aAAA,EAAA,EAAA,EAAA;MAAI,SAAA,GAAY;MACZ,QAAA,GAAY;QACV,CAAE,QAAF,CADU;QAEV,QAAA,CAAE,CAAF,CAAA;iBAAS,IAAA,CAAK,CAAL;QAAT,CAFU;;QAIV,qBAAA,GAAwB,QAAA,CAAE,CAAF,CAAA;UACtB,IAAG,IAAA,KAAK,EAAR;;cAAgB,CAAC,CAAE,EAAH,CAAM,IAAN;aAAhB;WAAA,MAAA;;cACgB,CAAC,CAAE,IAAH,CAAQ,gBAAR;aADhB;;AAEA,iBAAO;QAHe,CAJd;;QASV,qBAAA,GAAwB,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;UACtB,IAAA,CAAK,CAAL;UACA,IAAG,IAAA,KAAK,EAAR;;cAAgB,CAAC,CAAE,EAAH,CAAM,IAAN;aAAhB;WAAA,MAAA;;cACgB,CAAC,CAAE,IAAH,CAAQ,gBAAR;aADhB;;AAEA,iBAAO;QAJe,CATd;;QAeV,aAAA,GAAgB,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;UACd,IAAA,CAAK,CAAL;UACA,IAAG,GAAG,CAAC,MAAJ,CAAW,IAAC,CAAA,IAAZ,CAAH;;cAA0B,CAAC,CAAE,EAAH,CAAM,IAAN;aAA1B;WAAA,MAAA;;cAC0B,CAAC,CAAE,IAAH,CAAQ,gBAAR;aAD1B;;AAEA,iBAAO;QAJO,CAfN;QADhB;;MAuBI,EAAA,GAAK,IAAI,SAAJ,CAAc,QAAd;MACL,KAAA,CAAM,OAAN,EAAe,EAAf;aACA,EAAE,CAAC,KAAH,CAAA;IA1BC,CAAA;;MA6BH;;AACA,WAAO;EAlCyD,EA7ElE;;;EAkHA,IAAC,CAAE,2CAAF,CAAD,GAAmD,QAAA,CAAE,CAAF,EAAK,IAAL,CAAA;AACnD,QAAA,CAAA,EAAA,SAAA,EAAA,MAAA;;IACE,CAAA,CAAE,SAAF,CAAA,GAAgB,OAAA,CAAQ,yBAAR,CAAhB;IACA,CAAA,CAAE,CAAF,CAAA,GAAgB,SAAhB,EAFF;;IAIE,MAAA,GAAS,CACP,MADO,EAEP,aAFO,EAGP,OAHO,EAIP,KAJO,EAKP,+DALO,EAMP,MANO,EAOP,MAPO,EAQP,MARO;IAWN,CAAA,CAAA,CAAA,GAAA,EAAA;AACL,UAAA,SAAA,EAAA,KAAA,EAAA,gBAAA,EAAA,EAAA,EAAA,QAAA,EAAA,sBAAA,EAAA;MAAI,KAAA,GAAY,MAAA,CAAO,OAAP;MACZ,SAAA,GAAY;MACZ,QAAA,GAAY;;QAEV,MAFU;;QAIV,CAAA,CAAE,CAAE,KAAF,CAAF;QAAc,gBAAA,GAAmB,QAAA,CAAE,CAAF,CAAA;UAC/B,IAAoB,CAAA,KAAK,KAAzB;YAAA,IAAC,CAAA,IAAI,CAAC,KAAN,GAAc,GAAd;;iBACA,IAAA,CAAK,QAAL;QAAe,oBAAf;QAAqC,IAAC,CAAC,IAAvC;QAF+B,CAAjC,CAJU;;QAQV,qBAAA,GAAwB,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;UACtB,KAAqB,GAAG,CAAC,IAAJ,CAAS,CAAT,CAArB;AAAA,mBAAO,IAAA,CAAK,CAAL,EAAP;;UACA,IAAiB,CAAC,CAAC,UAAF,CAAa,IAAb,CAAjB;AAAA,mBAAO,IAAA,CAAK,CAAL,EAAP;;UACA,IAAC,CAAA,IAAI,CAAC,KAAK,CAAC,IAAZ,CAAiB,CAAC,uBAAlB;iBACA,IAAA,CAAK,CAAL;QAJsB,CARd;;QAcV,sBAAA,GAAyB,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;UACvB,KAAqB,GAAG,CAAC,IAAJ,CAAS,CAAT,CAArB;AAAA,mBAAO,IAAA,CAAK,CAAL,EAAP;;UACA,KAAqB,CAAC,CAAC,UAAF,CAAa,IAAb,CAArB;AAAA,mBAAO,IAAA,CAAK,CAAL,EAAP;;UACA,IAAG,IAAC,CAAA,IAAI,CAAC,KAAK,CAAC,MAAZ,GAAqB,CAAxB;AACE,mBAAO,IAAA,CAAK,CAAA,8BAAA,CAAA,CAAiC,GAAA,CAAI,CAAJ,CAAjC,CAAA,CAAL,EADT;WAFR;;iBAKQ,IAAA,CAAK,CAAL;QANuB,CAdf;;QAsBV,QAAA,CAAE,CAAF;QAAK,IAAL,CAAA;iBAAe,SAAS,CAAC,IAAV,CAAe,CAAf,EAAf;QAAA,CAtBU;QAFhB;;MA2BI,EAAA,GAAK,IAAI,SAAJ,CAAc,QAAd;MACL,KAAA,CAAM,OAAN,EAAe,EAAE,CAAC,IAAlB;aACA,EAAE,CAAC,KAAH,CAAA;IA9BC,CAAA;;MAiCH;;AACA,WAAO;EAlD0C,EAlHnD;;;EAyKA,IAAG,OAAO,CAAC,IAAR,KAAgB,MAAnB;IAAkC,CAAA,CAAA,CAAA,GAAA,EAAA;;;aAGhC,IAAC,CAAE,2CAAF,CAAD,CAAA;IAHgC,CAAA,IAAlC;;;EAzKA;;AAAA",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'MOONRIVER/BASICS'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\ntest                      = require '../../../apps/guy-test'\nPATH                      = require 'path'\n# FS                        = require 'fs'\ntypes                     = new ( require 'intertype' ).Intertype\n{ isa\n  equals\n  type_of\n  validate\n  validate_list_of }      = types.export()\nSQL                       = String.raw\nguy                       = require '../../../apps/guy'\nH                         = require '../../../lib/helpers'\n\n\n  # #.........................................................................................................\n  # probes_and_matchers = [\n  #   ]\n  # #.........................................................................................................\n  # for [ probe, matcher, error, ] in probes_and_matchers\n  #   await T.perform probe, matcher, error, -> return new Promise ( resolve, reject ) ->\n\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"send.call_count\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { Moonriver\n    $once     } = require '../../../apps/moonriver'\n  #.........................................................................................................\n  do =>\n    collector = []\n    pipeline  = [\n      [ 1, 2, 3, 5, ]\n      ( d, send ) -> send d * 2\n      ( d, send ) -> send d #; urge d\n      ( d, send ) -> collector.push d #; help collector\n      ]\n    mr = new Moonriver pipeline\n    mr.drive()\n    T?.eq collector, [ 2, 4, 6, 10, ]\n  #.........................................................................................................\n  do =>\n    collector = []\n    pipeline  = [\n      [ 'a', 'b', ]\n      ( d, send ) -> urge '^598^', d; send d\n      ( d, send ) ->\n        send d\n        if send.call_count is 1\n          send e for e from [ 1, 2, 3, 5, ].values()\n        return null\n      ( d, send ) -> send if isa.float d then d * 2 else d\n      ( d       ) -> urge d\n      ( d, send ) -> collector.push d #; help collector\n      ]\n    mr = new Moonriver pipeline\n    mr.drive()\n    T?.eq collector, [ 'a', 2, 4, 6, 10, 'b' ]\n  #.........................................................................................................\n  done?()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"can access pipeline from within transform, get user area\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { Moonriver } = require '../../../apps/moonriver'\n  #.........................................................................................................\n  do =>\n    collector = []\n    pipeline  = [\n      [ '^4564^', ]\n      ( d ) -> urge d\n      #.....................................................................................................\n      can_access_pipeline_1 = ( d ) ->\n        if @ is mr then T?.ok true\n        else            T?.fail \"^478-1^ not ok\"\n        return null\n      #.....................................................................................................\n      can_access_pipeline_2 = ( d, send ) ->\n        send d\n        if @ is mr then T?.ok true\n        else            T?.fail \"^478-2^ not ok\"\n        return null\n      #.....................................................................................................\n      has_user_area = ( d, send ) ->\n        send d\n        if isa.object @user then  T?.ok true\n        else                      T?.fail \"^478-3^ not ok\"\n        return null\n      #.....................................................................................................\n      ]\n    mr = new Moonriver pipeline\n    debug '^558^', mr\n    mr.drive()\n    # T?.eq collector, [ 2, 4, 6, 10, ]\n  #.........................................................................................................\n  done?()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"resettable state shared across transforms\" ] = ( T, done ) ->\n  # T?.halt_on_error()\n  { Moonriver } = require '../../../apps/moonriver'\n  { $ }         = Moonriver\n  #.........................................................................................................\n  source = [\n    '<h1>'\n    'The Opening'\n    '</h1>'\n    '<p>'\n    'Twas brillig, and the slithy toves Did gyre and gimble in the'\n    '<em>'\n    'wabe'\n    '</p>'\n    ]\n  #.........................................................................................................\n  do =>\n    first     = Symbol 'first'\n    collector = []\n    pipeline  = [\n      #.....................................................................................................\n      source\n      #.....................................................................................................\n      $ { first, }, initialize_stack = ( d ) ->\n        @user.stack = [] if d is first\n        urge '^3487^', 'initialize_stack()', @.user\n      #.....................................................................................................\n      push_opening_to_stack = ( d, send ) ->\n        return send d unless isa.text d\n        return send d if d.startsWith '</'\n        @user.stack.push d[ 1 ... d.length - 1 ]\n        send d\n      #.....................................................................................................\n      pop_closing_from_stack = ( d, send ) ->\n        return send d unless isa.text d\n        return send d unless d.startsWith '</'\n        if @user.stack.length < 1\n          return send \"error: extraneous closing tag #{rpr d}\"\n        # matching_tag\n        send d\n      #.....................................................................................................\n      ( d, send ) -> collector.push d #; help collector\n      #.....................................................................................................\n      ]\n    mr = new Moonriver pipeline\n    debug '^558^', mr.user\n    mr.drive()\n    # T?.eq collector, [ 2, 4, 6, 10, ]\n  #.........................................................................................................\n  done?()\n  return null\n\n\n\n############################################################################################################\nif require.main is module then do =>\n  # test @\n  # @[ \"send.call_count\" ]()\n  @[ \"resettable state shared across transforms\" ]()\n  # @[ \"can access pipeline from within transform, get user area\" ]()\n  # test @[ \"can access pipeline from within transform, get user area\" ]\n\n\n"
  ]
}